/*
 *  Copyright IBM Corp. 2025
 *
 *  This source code is licensed under the Apache-2.0 license found in the
 *  LICENSE file in the root directory of this source tree.
 */

@use "@carbon/layout";
@use "@carbon/colors";
@use "@carbon/styles/scss/theme";
@use "@carbon/styles/scss/components/button/tokens";
@use "@carbon/styles/scss/motion";

// Import shared tokens from @carbon/ai-chat-components
// These are the public configurable tokens that are shared across both packages
@use "@carbon/ai-chat-components/scss/custom-properties" as shared-tokens;

.cds-aichat--container--render {
  /* **************************************************************************************************************** */

  /* Shared tokens from @carbon/ai-chat-components */
  /* These are imported and will be available as CSS custom properties */
  /* See @carbon/ai-chat-components/scss/_custom-properties.scss for the full list */

  /* **************************************************************************************************************** */

  /* Container-specific properties (ChatContainer floating widget) */

  /* Application sizing and positioning */
  --cds-aichat-max-height: 640px;

  /* WCAG 2.1 states that the widget must be usable at 320x256 (or the equivalent from zoom happening) https://www.w3.org/WAI/WCAG21/Understanding/reflow.html
  We make sure the min-height at least 150px (to show at least the header/footer and one line of text) and is the lower of 256px minus the spacing from the bottom of the view port or 100vh - the bottom position. */
  --cds-aichat-min-height: max(
    150px,
    calc(min(256px, 100vh) - var(--cds-aichat-bottom-position))
  );

  /* Container positioning */
  --cds-aichat-bottom-position: #{layout.$spacing-09};
  --cds-aichat-right-position: #{layout.$spacing-07};
  --cds-aichat-top-position: auto;
  --cds-aichat-left-position: auto;

  /* Container sizing */
  /* The smaller of 380px or the available width of the screen. This is to account for zoom levels pushing us to 320px. */
  --cds-aichat-width: min(380px, var(--cds-aichat-max-width));
  --cds-aichat-height: calc(100vh - (2 * #{layout.$spacing-07}));

  /* Container z-index */
  --cds-aichat-z-index: 99999;

  /* **************************************************************************************************************** */

  /* Launcher properties (ChatContainer-specific) */
  /* These properties control the floating launcher button appearance and behavior */

  /* Launcher sizing and positioning */
  --cds-aichat-launcher-default-size: 56px;
  --cds-aichat-launcher-position-bottom: #{layout.$spacing-09};
  --cds-aichat-launcher-position-right: #{layout.$spacing-07};
  --cds-aichat-launcher-extended-width: 280px;

  /* Launcher colors */
  --cds-aichat-launcher-color-background: #{tokens.$button-primary};
  --cds-aichat-launcher-color-avatar: #{theme.$text-on-color};
  --cds-aichat-launcher-color-background-hover: #{tokens.$button-primary-hover};
  --cds-aichat-launcher-color-background-active: #{tokens.$button-primary-active};
  --cds-aichat-launcher-color-focus-border: #{theme.$text-on-color};
  --cds-aichat-launcher-mobile-color-text: #{theme.$text-on-color};

  /* Launcher expanded message colors */
  --cds-aichat-launcher-expanded-message-color-text: #{theme.$text-on-color};
  --cds-aichat-launcher-expanded-message-color-background: #{tokens.$button-primary};
  --cds-aichat-launcher-expanded-message-color-background-hover: #{tokens.$button-primary-hover};
  --cds-aichat-launcher-expanded-message-color-background-active: #{tokens.$button-primary-active};
  --cds-aichat-launcher-expanded-message-color-focus-border: #{theme.$text-on-color};

  /* Unread indicator colors */
  --cds-aichat-unread-indicator-color-background: #{theme.$support-error};
  --cds-aichat-unread-indicator-color-text: #{theme.$text-on-color};

  /* **************************************************************************************************************** */

  /* Home screen animation index (internal) */
  /* Note: This is set per-element in HomeScreen.scss for staggered animations */
}

.cds-aichat--container--render .cds-aichat--widget--rounded {
  --cds-aichat-border-radius: #{layout.$spacing-03};
}

.cds-aichat--container--render.cds-aichat--is-phone {
  /* Fallbacks for older browsers */
  --cds-aichat-width: calc(100vw - 4px);
  --cds-aichat-height: calc(100vh - 4px);
  --cds-aichat-left-position: 2;
  --cds-aichat-top-position: 2;
  --cds-aichat-max-width: auto;
  --cds-aichat-max-height: auto;
  --cds-aichat-min-height: auto;
  --cds-aichat-right-position: auto;
}

@supports (height: 100dvh) {
  .cds-aichat--container--render.cds-aichat--is-phone {
    --cds-aichat-width: calc(100dvw - 4px);
    --cds-aichat-height: calc(100dvh - 4px);
  }
}
