/* 
 *  Copyright IBM Corp. 2025
 *  
 *  This source code is licensed under the Apache-2.0 license found in the
 *  LICENSE file in the root directory of this source tree.
 */

@use "@carbon/layout";
@use "@carbon/styles/scss/theme";
@use "@carbon/styles/scss/utilities/convert" as *;
@use "@carbon/styles/scss/components/button/tokens" as *;
@use "../../../styles/chat-theme";

// Mixin to apply proper radius
@mixin footer-button-radius($radius) {
  // Non-column layout
  &:not(.cds-aichat--footer-button-components--column) {
    gap: rem(1px);

    &:not(:has([kind="ghost"])) {
      background-color: $button-separator;
    }

    &:has([kind="ghost"]) {
      border-block-start: rem(1px) solid theme.$chat-bubble-border;
    }

    .cds-aichat--button-item {
      &:first-child::part(button) {
        border-end-start-radius: max(0px, calc(#{$radius} - rem(1px)));
      }

      &:last-child::part(button) {
        border-end-end-radius: max(0px, calc(#{$radius} - rem(1px)));
      }
    }
  }

  // Column layout
  &.cds-aichat--footer-button-components--column {
    flex-direction: column;

    .cds-aichat--button-item {
      &[kind="ghost"] {
        border-block-start: rem(1px) solid theme.$chat-bubble-border;
      }

      &:last-child::part(button) {
        border-end-end-radius: max(0px, calc(#{$radius} - rem(1px)));
        border-end-start-radius: max(0px, calc(#{$radius} - rem(1px)));
      }
    }
  }
}

.cds-aichat--footer-button-components {
  display: flex;
  inline-size: 100%;

  cds-button.cds-aichat--button-item {
    flex: auto;
  }

  cds-button[href][kind="ghost"] svg {
    fill: theme.$link-primary;
  }
}

// Corner rounding styles
// Note: Tiles shouldn't take the border radius when `.cds-aichat--widget--rounded` is set on the widget. as they are always rounded.
// Important Note: FooterButtonComponents is a common child for `panel` and `tile`. we have to be specific with the selectors, and must scope them accordingly.

// Footer button styles scoped to tile
cds-tile {
  .cds-aichat--footer-button-components {
    @include footer-button-radius(layout.$spacing-03);
  }
}

// Usage inside rounded widget panel, we remove one more pixel as the overlay panel brings its own border of 1px.
.cds-aichat--widget--rounded
  .cds-aichat--overlay-panel
  .cds-aichat--footer-button-components {
  @include footer-button-radius(calc(chat-theme.$border-radius - rem(1px)));
}
// Corner rounding styles end
.cds-aichat--widget__animation-container--with-branding-banner
  .cds-aichat--overlay-panel
  .cds-aichat--footer-button-components,
.cds-aichat--widget:not(.cds-aichat--widget--rounded)
  .cds-aichat--widget__animation-container:not(
    .cds-aichat--widget__animation-container--with-branding-banner
  )
  .cds-aichat--overlay-panel
  .cds-aichat--footer-button-components {
  .cds-aichat--button-item:first-child::part(button) {
    border-end-start-radius: 0;
  }

  .cds-aichat--button-item:last-child::part(button) {
    border-end-end-radius: 0;
  }
}

.cds-aichat--widget__animation-container--with-branding-banner
  .cds-aichat--overlay-panel
  .cds-aichat--footer-button-components--column
  .cds-aichat--button-item.cds-aichat--button-item:last-child::part(button),
.cds-aichat--footer-button-components.cds-aichat--footer-button-components--column
  .cds-aichat--button-item.cds-aichat--button-item:not(
    :last-child::part(button)
  ) {
  border-end-end-radius: 0;
  border-end-start-radius: 0;
}
