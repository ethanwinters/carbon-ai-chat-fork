import { ArgTypes, Canvas, Meta } from '@storybook/addon-docs/blocks';
import * as FeedbackButtonsReactStories from "./feedback-buttons-react.stories.jsx";

<Meta of={FeedbackButtonsReactStories} parameters={{ previewTabs: { "storybook/docs/panel": { title: "Overview" } } }} />

# Feedback buttons

[Source code](https://github.com/carbon-design-system/carbon-ai-chat/tree/main/packages/ai-chat-components/src/components/feedback) &nbsp;|&nbsp; [Feedback](https://github.com/carbon-design-system/carbon-ai-chat/issues)

{/* <!-- START doctoc generated TOC please keep comment here to allow auto update --> <!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --> */}

## Table of Contents

- [Overview](#overview)
- [Component API](#component-api)
- [Feedback](#feedback)

{/* <!-- END doctoc generated TOC please keep comment here to allow auto update --> */}

## Overview

The `<FeedbackButtons>` component wraps the `cds-aichat-feedback-buttons` web component and exposes a React-friendly API for collecting quick thumbs up/down sentiment on AI responses.

### Getting started

Here's a quick example to get you started.

```jsx
import FeedbackButtons from "@carbon/ai-chat-components/es/react/feedback-buttons.js";

function FeedbackButtonsExample() {
  return (
    <FeedbackButtons
      positiveLabel="Thumbs up"
      negativeLabel="Thumbs down"
      onClick={(event) => {
        const { isPositive } = event.detail;
        console.log(isPositive ? "Positive feedback" : "Negative feedback");
      }}
    />
  );
}
```

## Component API

<ArgTypes of={FeedbackButtonsReactStories.Default} />

### Usage Patterns

#### Simple Feedback Recording

```jsx
function SimpleFeedback() {
  const [state, setState] = React.useState({
    positiveSelected: false,
    negativeSelected: false,
    disabled: false,
  });

  return (
    <FeedbackButtons
      isPositiveSelected={state.positiveSelected}
      isNegativeSelected={state.negativeSelected}
      isPositiveDisabled={state.disabled}
      isNegativeDisabled={state.disabled}
      positiveLabel="Thumbs up"
      negativeLabel="Thumbs down"
      onClick={(event) => {
        const { isPositive } = event.detail;
        const updates =
          isPositive
            ? { positiveSelected: true, negativeSelected: false }
            : { positiveSelected: false, negativeSelected: true };
        setState({ ...state, ...updates, disabled: true });
        recordFeedback({
          messageId: "123",
          sentiment: isPositive ? "positive" : "negative",
        });
      }}
    />
  );
}
```

#### With Feedback Details Panel

```jsx
import FeedbackButtons from "@carbon/ai-chat-components/es/react/feedback-buttons.js";
import Feedback from "@carbon/ai-chat-components/es/react/feedback.js";

function DetailedFeedback() {
  const [isNegativeOpen, setNegativeOpen] = React.useState(false);

  return (
    <>
      <FeedbackButtons
        hasNegativeDetails
        panelID="feedback-panel-123"
        negativeLabel="Thumbs down"
        positiveLabel="Thumbs up"
        isNegativeOpen={isNegativeOpen}
        onClick={(event) => {
          const { isPositive } = event.detail;
          if (isPositive) {
            recordFeedback({ messageId: "123", sentiment: "positive" });
          } else {
            setNegativeOpen(true);
          }
        }}
      />
      <Feedback
        isOpen={isNegativeOpen}
        title="What went wrong?"
        categories={["Inaccurate", "Unhelpful", "Inappropriate"]}
        onClose={() => setNegativeOpen(false)}
      />
    </>
  );
}
```

#### Toggle Behavior

```jsx
function ToggleableFeedback() {
  const [selection, setSelection] = React.useState({
    positive: false,
    negative: false,
  });

  return (
    <FeedbackButtons
      isPositiveSelected={selection.positive}
      isNegativeSelected={selection.negative}
      positiveLabel="Helpful"
      negativeLabel="Not helpful"
      onClick={(event) => {
        const { isPositive } = event.detail;
        const nextSelection = {
          positive: isPositive ? !selection.positive : false,
          negative: isPositive ? false : !selection.negative,
        };
        setSelection(nextSelection);
        const sentiment = nextSelection.positive
          ? "positive"
          : nextSelection.negative
            ? "negative"
            : null;
        recordFeedback({ messageId: "123", sentiment });
      }}
    />
  );
}
```

### Accessibility

- Buttons include customizable labels for screen readers
- Uses `aria-pressed` to indicate selected state
- Uses `aria-controls` to link to detail panels when applicable
- Keyboard navigable with standard tab/enter interactions

## Feedback

Open an issue at https://github.com/carbon-design-system/carbon-ai-chat/issues to provide feedback or request changes.
